{{!-- template-lint-disable no-action --}}
<div class="certification-informations">
  <div class="buttons-row">
    <PixButton
      @route="authenticated.users.get"
      @size="small"
      @model={{this.certification.userId}}
    >
      Voir les détails de l'utilisateur
    </PixButton>
    <PixButton
      @backgroundColor="red"
      @isDisabled={{this.isCertificationCancelled}}
      @size="small"
      @triggerAction={{this.onCancelCourseButtonClick}}
      data-test-id="Annuler la certification"
    >
      Annuler la certification
      </PixButton>
  </div>

  <div class="row">
    <div class="col">
      <div class="card {{if this.editingCandidateResults 'border-primary'}}">
        <div class="card-body">
          <h5 class="card-title">
            <Certification::CertificationInfoPublished @record={{this.certification}} @float={{true}} />État
          </h5>
          <div class="card-text">
            <Certification::CertificationInfoField @value={{this.certification.sessionId}} @edition={{false}} @label="Session :" @linkRoute="authenticated.sessions.session" />
            <Certification::CertificationStatusSelect @certification={{this.certification}} @edition={{this.editingCandidateResults}} />
            <Certification::CertificationInfoField @value={{this.certification.creationDate}} @edition={{false}} @label="Créée le :" />
            <Certification::CertificationInfoField @value={{this.certification.completionDate}} @edition={{false}} @label="Terminée le :" />
            <Certification::CertificationInfoField @value={{this.certification.publishedText}} @edition={{false}} @label="Publiée :" />
            <Certification::CertificationInfoField @value={{this.certification.cleaCertificationStatusLabel}} @edition={{false}} @label="Certification CléA numérique :" @class="certification-informations__complementary-certification--{{this.certification.cleaCertificationStatus}}" />
            <Certification::CertificationInfoField @value={{this.certification.pixPlusDroitMaitreCertificationStatusLabel}} @edition={{false}} @label="Certification Pix+ Droit Maître :" @class="certification-informations__complementary-certification--{{this.certification.pixPlusDroitMaitreCertificationStatus}}" />
            <Certification::CertificationInfoField @value={{this.certification.pixPlusDroitExpertCertificationStatusLabel}} @edition={{false}} @label="Certification Pix+ Droit Expert :" @class="certification-informations__complementary-certification--{{this.certification.pixPlusDroitExpertCertificationStatus}}" />
          </div>
        </div>
      </div>
    </div>

    <div class="col">
      <Certification::CertificationInformationCandidateCard
          @editingCandidateResults={{this.editingCandidateResults}}
          @certification={{this.certification}}
          @onEditButtonClick={{this.openCandidateEditModal}}
          @isModifyButtonDisabled={{this.isModifyButtonDisabled}}
      />
    </div>
  </div>

  {{#if this.hasIssueReports}}
    <section class="card certification-informations__certification-issue-reports">
      <div class="card-body">
        <h1 class="card-title certification-informations__certification-issue-reports__title">Signalements</h1>
        <Certification::CertificationIssueReports
          @hasImpactfulIssueReports={{this.hasImpactfulIssueReports}}
          @hasUnimpactfulIssueReports={{this.hasUnimpactfulIssueReports}}
          @impactfulCertificationIssueReports={{this.impactfulCertificationIssueReports}}
          @unimpactfulCertificationIssueReports={{this.unimpactfulCertificationIssueReports}}
        />
      </div>
    </section>
  {{/if}}

  <div class="row">
    <div class="col">
      <Certification::CertificationInformationJuryCommentsCard
          @editingCandidateResults={{this.editingCandidateResults}}
          @certification={{this.certification}}
      />
    </div>
  </div>
  <div class="row">
    <div class="col">
      <Certification::CertificationInformationResultsCard
            @editingCandidateResults={{this.editingCandidateResults}}
            @certification={{this.certification}}
            @onUpdateScore={{this.onUpdateScore}}
            @onUpdateLevel={{this.onUpdateLevel}}
      />
    </div>
  </div>
  {{#if this.isValid}}
    <div class="row">
      <div class="col certification-informations__actions form-actions">
        {{#if this.editingCandidateResults}}
          <PixButton
            @size="small"
            @backgroundColor="transparent-light"
            @isBorderVisible={{true}}
            @triggerAction={{this.onCandidateResultsCancel}}
            aria-label="Annuler la modification des résultats du candidat"
          >
            Annuler
          </PixButton>
          <PixButton
            @size="small"
            @triggerAction={{this.onCandidateResultsSaveConfirm}}
            @backgroundColor="green"
            aria-label="Enregistrer les résultats du candidat"
          >
            Enregistrer
          </PixButton>
        {{else}}
          <PixButton
            @size="small"
            @triggerAction={{this.onCandidateResultsEdit}}
            aria-label="Modifier les résultats du candidat"
            @isDisabled={{this.editingCandidateInformations}}
          >
            Modifier
          </PixButton>
        {{/if}}
      </div>
    </div>
  {{/if}}
  <ConfirmPopup
          @message={{this.confirmMessage}}
          @error={{this.confirmErrorMessage}}
          @confirm={{action this.confirmAction}}
          @cancel={{action this.onCandidateResultsCancelConfirm}}
          @show={{this.displayConfirm}} />
</div>
<Certification::CandidateEditModal
  @isDisplayed={{this.isCandidateEditModalOpen}}
  @onCancelButtonsClicked={{this.closeCandidateEditModal}}
  @onFormSubmit={{this.onCandidateInformationSave}}
  @candidate={{this.certification}}
  @countries={{this.countries}}
/>
