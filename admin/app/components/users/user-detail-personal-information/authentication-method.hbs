<header class="page-section__header">
  <h2 class="page-section__title">Méthodes de connexion</h2>
</header>

<table class="authentication-method">

  <caption class="authentication-method__caption">Méthodes de connexion</caption>

  <tbody>
    <tr data-test-email>
      <td class="authentication-method__name-column">Adresse e-mail</td>
      <td>
        {{#if @user.hasEmailAuthenticationMethod}}
          <FaIcon
            @icon="check-circle"
            aria-label="L'utilisateur a une méthode de connexion avec adresse e-mail"
            class="authentication-method__check"
          />
        {{else}}
          <FaIcon
            @icon="times-circle"
            aria-label="L'utilisateur n'a pas de méthode de connexion avec adresse e-mail"
            class="authentication-method__uncheck"
          />
        {{/if}}
      </td>
      <td>
        {{#if @user.isAllowedToRemoveEmailAuthenticationMethod}}
          <PixButton
            class="user-authentication-method__remove-button"
            @size="small"
            @backgroundColor="red"
            @triggerAction={{fn @toggleDisplayRemoveAuthenticationMethodModal "EMAIL"}}
            data-test-remove-email
          >Supprimer</PixButton>
        {{/if}}
        {{#if @user.isAllowedToAddEmailAuthenticationMethod}}
          <PixButton @triggerAction={{this.toggleAddAuthenticationMethodModal}} @size="small">Ajouter une adresse e-mail</PixButton>
        {{/if}}
      </td>
    </tr>

    <tr data-test-username>
      <td class="authentication-method__name-column">Identifiant</td>
      <td>
        {{#if @user.hasUsernameAuthenticationMethod}}
          <FaIcon
            @icon="check-circle"
            aria-label="L'utilisateur a une méthode de connexion avec identifiant"
            class="authentication-method__check"
          />
        {{else}}
          <FaIcon
            @icon="times-circle"
            aria-label="L'utilisateur n'a pas de méthode de connexion avec identifiant"
            class="authentication-method__uncheck"
          />
        {{/if}}
      </td>
      <td>
        {{#if @user.isAllowedToRemoveUsernameAuthenticationMethod}}
          <PixButton
            class="user-authentication-method__remove-button"
            @size="small"
            @backgroundColor="red"
            @triggerAction={{fn @toggleDisplayRemoveAuthenticationMethodModal "USERNAME"}}
            data-test-remove-username
          >Supprimer</PixButton>
        {{/if}}
      </td>
    </tr>

    <tr data-test-pole-emploi>
      <td class="authentication-method__name-column">Pôle emploi</td>
      <td>
        {{#if @user.hasPoleEmploiAuthenticationMethod}}
          <FaIcon
            @icon="check-circle"
            aria-label="L'utilisateur a une méthode de connexion Pôle Emploi"
            class="authentication-method__check"
          />
        {{else}}
          <FaIcon
            @icon="times-circle"
            aria-label="L'utilisateur n'a pas de méthode de connexion Pôle Emploi"
            class="authentication-method__uncheck"
          />
        {{/if}}
      </td>
      <td>
        {{#if @user.isAllowedToRemovePoleEmploiAuthenticationMethod}}
          <PixButton
            class="user-authentication-method__remove-button"
            @size="small"
            @backgroundColor="red"
            @triggerAction={{fn @toggleDisplayRemoveAuthenticationMethodModal "POLE_EMPLOI"}}
            data-test-remove-pole-emploi
          >Supprimer</PixButton>
        {{/if}}
      </td>
    </tr>

    <tr data-test-gar>
      <td class="authentication-method__name-column">Médiacentre</td>
      <td>
        {{#if @user.hasGarAuthenticationMethod}}
          <FaIcon
            @icon="check-circle"
            aria-label="L'utilisateur a une méthode de connexion Médiacentre"
            class="authentication-method__check"
          />
        {{else}}
          <FaIcon
            @icon="times-circle"
            aria-label="L'utilisateur n'a pas de méthode de connexion Médiacentre"
            class="authentication-method__uncheck"
          />
        {{/if}}
      </td>
      <td>
        {{#if @user.isAllowedToRemoveGarAuthenticationMethod}}
          <PixButton
            class="user-authentication-method__remove-button"
            @size="small"
            @backgroundColor="red"
            @triggerAction={{fn @toggleDisplayRemoveAuthenticationMethodModal "GAR"}}
            data-test-remove-mediacentre
          >Supprimer</PixButton>
        {{/if}}
      </td>
      <td>
        {{#if @user.hasGarAuthenticationMethod}}
          <PixButton @triggerAction={{this.toggleReassignGarAuthenticationMethodModal}} @size="small">
            Déplacer cette méthode de connexion
          </PixButton>
        {{/if}}
      </td>
    </tr>
  </tbody>
</table>

<Users::UserDetailPersonalInformation::AddAuthenticationMethodModal
  @showAddAuthenticationMethodModal={{this.showAddAuthenticationMethodModal}}
  @onChangeNewEmail={{this.onChangeNewEmail}}
  @showAlreadyExistingEmailError={{this.showAlreadyExistingEmailError}}
  @toggleAddAuthenticationMethodModal={{this.toggleAddAuthenticationMethodModal}}
  @submitAddingPixAuthenticationMethod={{this.submitAddingPixAuthenticationMethod}}
/>

<Users::UserDetailPersonalInformation::ReassignGarAuthenticationMethodModal
  @showReassignGarAuthenticationMethodModal={{this.showReassignGarAuthenticationMethodModal}}
  @onChangeTargetUserId={{this.onChangeTargetUserId}}
  @toggleReassignGarAuthenticationMethodModal={{this.toggleReassignGarAuthenticationMethodModal}}
  @submitReassignGarAuthenticationMethod={{this.submitReassignGarAuthenticationMethod}}
/>