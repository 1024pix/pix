const buildChallenge = function buildChallenge({
  id = 'recwWzTquPlvIl4So',
  consigne = 'Les moteurs de recherche affichent certains liens en raison d\'un accord commercial.\n\nDans quels encadrés se trouvent ces liens ?',
  propositions = '- 1\n- 2\n- 3\n- 4\n- 5',
  typeDEpreuve = 'QCM',
  tests = [
    'rec8JuSJXIaGEb87M',
    'recSaR2WAYZdGQpTx',
    'recrRaLs10oBNGZ86',
    'recBoha6fgjOcmX1N',
    'reccPO6AYavta2Kpa',
    'recYQS5fiiRqmKBDP',
    'recMjdIGpEIDaKB8u',
    'rec4qvsIuGj5FN5Ej',
    'recP3QJ6PtAOQ5VAq',
    'rec32nWxGA03Ygplx',
    'recNPB7dTNt5krlMA',
    'rece0Id3wMXgTjJeE',
    'rec0pJodmLlAvtU7q',
    'recyaN7FCESzSsVXL',
  ],
  illustrationDeLaConsigne = [
    {
      id: 'atteE9d2Pp6xE76G1',
      url: 'https://dl.airtable.com/2MGErxGTQl2g2KiqlYgV_venise4.png',
      filename: 'venise4.png',
      size: 1068844,
      type: 'image/png',
      thumbnails: {
        small: {
          url: 'https://dl.airtable.com/FI4JEGbyRv28iSszh9Q2_small_venise4.png',
          width: 41,
          height: 36,
        },
        large: {
          url: 'https://dl.airtable.com/ReK361SpWWKtWQKqhrIA_large_venise4.png',
          width: 512,
          height: 512,
        },
      },
    },
  ],
  pieceJointe = [
    {
      'id': 'attrGPZKd1Ji8jqwn',
      'url': 'https://dl.airtable.com/rsXNJrSPuepuJQDByFVA_navigationdiaporama5.odp',
      'filename': 'navigationdiaporama5.odp',
      'size': 64957,
      'type': 'application/vnd.oasis.opendocument.presentation',
    },
    {
      'id': 'att4DuFUC0sSBk7N7',
      'url': 'https://dl.airtable.com/nHWKNZZ7SQeOKsOvVykV_navigationdiaporama5.pptx',
      'filename': 'navigationdiaporama5.pptx',
      'size': 67111,
      'type': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
      'thumbnails': {
        'small': {
          'url': 'https://dl.airtable.com/att4DuFUC0sSBk7N7-ef71b3e171b28e96-36x20.png',
          'width': 36,
          'height': 20,
        },
        'large': {
          'url': 'https://dl.airtable.com/att4DuFUC0sSBk7N7-f80b48806ae3d0e3-512x288.png',
          'width': 512,
          'height': 288,
        },
      },
    },
  ],
  bonnesReponses = '1, 5',
  typePeda = 'q-situation',
  auteur = [
    'SPS',
  ],
  timer = 1234,
  licenceImage = 'écran libre',
  declinable = 'facilement',
  accessibilite = 'Non',
  t1EspacesCasseAccents = 'Activé',
  t2Ponctuation = 'Désactivé',
  t3DistanceDEdition = 'Activé',
  competences = [
    'recsvLz0W2ShyfD63',
  ],
  genealogie = 'Prototype 1',
  statut = 'validé',
  scoring = '1: @outilsTexte2\n2: @outilsTexte4',
  embedURL = 'https://github.io/page/epreuve.html',
  embedTitle = 'Epreuve de selection de dossier',
  embedHeight = 500,
  acquix = [
    'recUDrCWD76fp5MsE',
  ],
  acquis = [
    '@modèleEco3',
  ],
  preview = 'http://staging.pix-dev.ovh/challenges/recwWzTquPlvIl4So/preview',
  recordID = id,
  domaines = [
    'recvoGdo7z2z7pXWa',
  ],
  createdTime = '2016-08-24T11:59:02.000Z',
  format = 'mots',
  illustrationAlt = 'texte alternatif à l\'image',
  langues = [
    'Francophone',
  ],
  autoReply = false,
} = {}) {

  return rawBuildChallenge({
    id,
    consigne,
    propositions,
    typeDEpreuve,
    tests,
    illustrationDeLaConsigne,
    pieceJointe,
    bonnesReponses,
    typePeda,
    auteur,
    timer,
    licenceImage,
    declinable,
    accessibilite,
    t1EspacesCasseAccents,
    t2Ponctuation,
    t3DistanceDEdition,
    competences,
    genealogie,
    statut,
    scoring,
    embedURL,
    embedTitle,
    embedHeight,
    acquix,
    acquis,
    preview,
    recordID,
    domaines,
    createdTime,
    illustrationAlt,
    format,
    langues,
    autoReply,
  });
};

buildChallenge.untimed = function buildUntimedChallenge({
  id = 'recwWzTquPlvIl4So',
  consigne = 'Les moteurs de recherche affichent certains liens en raison d\'un accord commercial.\n\nDans quels encadrés se trouvent ces liens ?',
  propositions = '- 1\n- 2\n- 3\n- 4\n- 5',
  typeDEpreuve = 'QCM',
  tests = [
    'rec8JuSJXIaGEb87M',
    'recSaR2WAYZdGQpTx',
    'recrRaLs10oBNGZ86',
    'recBoha6fgjOcmX1N',
    'reccPO6AYavta2Kpa',
    'recYQS5fiiRqmKBDP',
    'recMjdIGpEIDaKB8u',
    'rec4qvsIuGj5FN5Ej',
    'recP3QJ6PtAOQ5VAq',
    'rec32nWxGA03Ygplx',
    'recNPB7dTNt5krlMA',
    'rece0Id3wMXgTjJeE',
    'rec0pJodmLlAvtU7q',
    'recyaN7FCESzSsVXL',
  ],
  illustrationDeLaConsigne = [
    {
      id: 'atteE9d2Pp6xE76G1',
      url: 'https://dl.airtable.com/2MGErxGTQl2g2KiqlYgV_venise4.png',
      filename: 'venise4.png',
      size: 1068844,
      type: 'image/png',
      thumbnails: {
        small: {
          url: 'https://dl.airtable.com/FI4JEGbyRv28iSszh9Q2_small_venise4.png',
          width: 41,
          height: 36,
        },
        large: {
          url: 'https://dl.airtable.com/ReK361SpWWKtWQKqhrIA_large_venise4.png',
          width: 512,
          height: 512,
        },
      },
    },
  ],
  pieceJointe = [
    {
      'id': 'attrGPZKd1Ji8jqwn',
      'url': 'https://dl.airtable.com/rsXNJrSPuepuJQDByFVA_navigationdiaporama5.odp',
      'filename': 'navigationdiaporama5.odp',
      'size': 64957,
      'type': 'application/vnd.oasis.opendocument.presentation',
    },
    {
      'id': 'att4DuFUC0sSBk7N7',
      'url': 'https://dl.airtable.com/nHWKNZZ7SQeOKsOvVykV_navigationdiaporama5.pptx',
      'filename': 'navigationdiaporama5.pptx',
      'size': 67111,
      'type': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
      'thumbnails': {
        'small': {
          'url': 'https://dl.airtable.com/att4DuFUC0sSBk7N7-ef71b3e171b28e96-36x20.png',
          'width': 36,
          'height': 20,
        },
        'large': {
          'url': 'https://dl.airtable.com/att4DuFUC0sSBk7N7-f80b48806ae3d0e3-512x288.png',
          'width': 512,
          'height': 288,
        },
      },
    },
  ],
  bonnesReponses = '1, 5',
  typePeda = 'q-situation',
  auteur = [
    'SPS',
  ],
  licenceImage = 'écran libre',
  declinable = 'facilement',
  accessibilite = 'Non',
  t1EspacesCasseAccents = 'Activé',
  t2Ponctuation = 'Désactivé',
  t3DistanceDEdition = 'Activé',
  competences = [
    'recsvLz0W2ShyfD63',
  ],
  genealogie = 'Prototype 1',
  statut = 'validé',
  scoring = '1: @outilsTexte2\n2: @outilsTexte4',
  embedURL = 'https://github.io/page/epreuve.html',
  embedTitle = 'Epreuve de selection de dossier',
  embedHeight = 500,
  acquix = [
    'recUDrCWD76fp5MsE',
  ],
  acquis = [
    '@modèleEco3',
  ],
  preview = 'http://staging.pix-dev.ovh/challenges/recwWzTquPlvIl4So/preview',
  recordID = id,
  domaines = [
    'recvoGdo7z2z7pXWa',
  ],
  createdTime = '2016-08-24T11:59:02.000Z',
  format = 'petit',
  illustrationAlt = 'texte alternatif à l\'image',
  langues = [
    'Francophone',
  ],
} = {}) {

  return rawBuildChallenge({
    id,
    consigne,
    propositions,
    typeDEpreuve,
    tests,
    illustrationDeLaConsigne,
    pieceJointe,
    bonnesReponses,
    typePeda,
    auteur,
    licenceImage,
    declinable,
    accessibilite,
    t1EspacesCasseAccents,
    t2Ponctuation,
    t3DistanceDEdition,
    competences,
    genealogie,
    statut,
    scoring,
    embedURL,
    embedTitle,
    embedHeight,
    acquix,
    acquis,
    preview,
    recordID,
    domaines,
    createdTime,
    illustrationAlt,
    format,
    langues,
  });
};

function rawBuildChallenge({
  id,
  consigne,
  propositions,
  typeDEpreuve,
  tests,
  illustrationDeLaConsigne,
  pieceJointe,
  bonnesReponses,
  typePeda,
  auteur,
  timer,
  licenceImage,
  declinable,
  accessibilite,
  t1EspacesCasseAccents,
  t2Ponctuation,
  t3DistanceDEdition,
  competences,
  genealogie,
  statut,
  scoring,
  embedURL,
  embedTitle,
  embedHeight,
  acquix,
  acquis,
  preview,
  recordID,
  domaines,
  createdTime,
  illustrationAlt,
  format,
  langues,
}) {

  return {
    id,
    'fields': {
      'id persistant': id,
      'Consigne': consigne,
      'Propositions': propositions,
      'Type d\'épreuve': typeDEpreuve,
      'Tests': tests,
      'Illustration de la consigne': illustrationDeLaConsigne,
      'Pièce jointe': pieceJointe,
      'Bonnes réponses': bonnesReponses,
      'Type péda': typePeda,
      'Auteur': auteur,
      'Timer': timer,
      'Licence image': licenceImage,
      'Déclinable': declinable,
      'Accessibilité': accessibilite,
      'T1 - Espaces, casse & accents': t1EspacesCasseAccents,
      'T2 - Ponctuation': t2Ponctuation,
      'T3 - Distance d\'édition': t3DistanceDEdition,
      'Compétences (via tube) (id persistant)': competences,
      'Généalogie': genealogie,
      'Statut': statut,
      'Scoring': scoring,
      'Embed URL': embedURL,
      'Embed title': embedTitle,
      'Embed height': embedHeight,
      'Acquix (id persistant)': acquix,
      'acquis': acquis,
      'Preview': preview,
      'Record ID': recordID,
      'domaines': domaines,
      'Texte alternatif illustration': illustrationAlt,
      'Format': format,
      'Langues': langues,
    },
    'createdTime': createdTime,
  };
}

buildChallenge.fromDomain = function buildChallengeFromDomain({
  domainChallenge,
  createdAt = '2018-03-15T14:38:03.000Z',
}) {

  const languages = [];
  for (const locale of domainChallenge.locales) {
    if (locale === 'fr') {
      languages.push('Francophone');
    }
    if (locale === 'fr-fr') {
      languages.push('Franco Français');
    }
    if (locale === 'en') {
      languages.push('Anglais');
    }
  }

  return {
    id: domainChallenge.id,
    'fields': {
      'id persistant': domainChallenge.id,
      'Consigne': domainChallenge.instruction,
      'Consigne alternative': domainChallenge.alternativeInstruction,
      'Propositions': domainChallenge.proposals,
      'Type d\'épreuve': domainChallenge.type,
      'Illustration de la consigne': [{ url: domainChallenge.illustrationUrl }],
      'Pièce jointe': domainChallenge.attachments ? domainChallenge.attachments.map((attachmentUrl) => {
        return { url: attachmentUrl };
      }) : null,
      'Bonnes réponses': 'Une solution',
      'Timer': domainChallenge.timer,
      'Compétences (via tube) (id persistant)': [domainChallenge.competenceId],
      'Statut': domainChallenge.status,
      'Embed URL': domainChallenge.embedUrl,
      'Embed title': domainChallenge.embedTitle,
      'Embed height': domainChallenge.embedHeight,
      'Acquix (id persistant)': domainChallenge.skills.map(({ id }) => id),
      'Texte alternatif illustration': domainChallenge.illustrationAlt,
      'Format': domainChallenge.format,
      'Réponse automatique': domainChallenge.autoReply ? 'Oui' : null,
      'Langues': languages,
      'T1 - Espaces, casse & accents': 'Activé',
      'T2 - Ponctuation': 'Désactivé',
      'T3 - Distance d\'édition': 'Activé',
      'Scoring': 'Le scoring',
    },
    'createdTime': createdAt,
  };
};

module.exports = buildChallenge;
