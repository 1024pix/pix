// Text-based user entries should be of limited length  - VARCHAR(X) - to avoid security risk
// Check there for rationale: docs/adr/0031-limiter-taille-saisie-utilisateur.md
const userEntryColumns = [
  { identifier: 'public.users.email', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.users.firstName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.users.lastName', rule: 'prefer-text-to-varchar' },
];

// External information system impose their own maximum variable, sometime fixed, length
const externalInformationSystemCodes = [
  { identifier: 'public.certification-candidates.birthINSEECode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.nationalApprenticeId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.nationalStudentId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.birthINSEECode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-cities.INSEECode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.MEFCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaign-participations.participantExternalId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.externalId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-centers.externalId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.externalId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organizations.externalId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organizations.formNPSUrl', rule: 'prefer-text-to-varchar' },
];

// Referential leverage AirTable which use sha1 as identifier
const shaIdentifiers = [
  { identifier: 'public.answers.challengeId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.assessments.lastChallengeId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-challenges.associatedSkillId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-challenges.challengeId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-challenges.competenceId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.feedbacks.challengeId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.competence-evaluations.competenceId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.competence-marks.competenceId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.knowledge-elements.competenceId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.knowledge-elements.skillId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.target-profiles_skills.skillId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.tutorial-evaluations.tutorialId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.user_tutorials.tutorialId', rule: 'prefer-text-to-varchar' },
];

const legitimateUsage = [...userEntryColumns, ...externalInformationSystemCodes, ...shaIdentifiers];

// The following entries have not yet been checked
const uncheckedColumns = [
  { identifier: 'public.account-recovery-demands.newEmail', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.account-recovery-demands.oldEmail', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.account-recovery-demands.temporaryKey', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.answers.result', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.assessments.competenceId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.assessments.courseId', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.assessments.lastQuestionState', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.assessments.type', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.authentication-methods.externalIdentifier', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.authentication-methods.identityProvider', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.badge-criteria.scope', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.badges.altMessage', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.badges.imageUrl', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.badges.title', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaign-participations.status', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaigns.code', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaigns.customResultPageButtonText', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaigns.idPixLabel', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaigns.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaigns.title', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.campaigns.type', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.birthCity', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.birthCountry', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.birthPostalCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.birthProvinceCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.email', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.firstName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.lastName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.resultRecipientEmail', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-candidates.sex', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-centers.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-challenges.associatedSkillName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-challenges.certifiableBadgeKey', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.birthCountry', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.birthPostalCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.birthplace', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.examinerComment', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.firstName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.lastName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.sex', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-courses.verificationCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-cities.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-cities.postalCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-countries.code', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-countries.commonName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-countries.matcher', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-cpf-countries.originalName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-issue-reports.category', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-issue-reports.description', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-issue-reports.resolution', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.certification-issue-reports.subcategory', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.competence-evaluations.status', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.complementary-certifications.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.feedbacks.category', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.feedbacks.userAgent', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.finalized-sessions.assignedCertificationOfficerName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.knex_migrations.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.knowledge-elements.source', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.knowledge-elements.status', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.memberships.organizationRole', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organization-invitations.code', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organization-invitations.email', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organization-invitations.status', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organizations.email', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organizations.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.organizations.provinceCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.partner-certifications.partnerKey', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.pix_roles.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.pole-emploi-sendings.type', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.reset-password-demands.email', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.reset-password-demands.temporaryKey', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.birthCity', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.birthCityCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.birthCountryCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.birthProvinceCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.department', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.diploma', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.division', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.educationalTeam', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.email', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.firstName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.group', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.lastName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.middleName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.preferredLastName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.sex', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.status', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.studentNumber', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.schooling-registrations.thirdName', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.sessions.accessCode', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.sessions.examinerGlobalComment', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.sessions.supervisorPassword', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.skill-sets.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.stages.prescriberTitle', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.stages.title', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.tags.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.target-profiles.category', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.target-profiles.imageUrl', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.target-profiles.name', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.users.lang', rule: 'prefer-text-to-varchar' },
  { identifier: 'public.users.username', rule: 'prefer-text-to-varchar' },
];

const varcharColumns = [...legitimateUsage, ...uncheckedColumns];

module.exports = varcharColumns;
